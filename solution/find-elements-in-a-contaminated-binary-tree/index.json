{
	"titleSlug": "find-elements-in-a-contaminated-binary-tree",
	"slug": "by-luobailin-remu",
	"url": "https://leetcode-cn.com/problems/find-elements-in-a-contaminated-binary-tree/solution/by-luobailin-remu/",
	"content": "## æ—¶é—´å¤æ‚åº¦ï¼š```log(N)```\n## ç©ºé—´å¤æ‚åº¦ï¼š```log(N)```\n\n## åŸç†ï¼š\n\nå¦‚æœå½“å‰èŠ‚ç‚¹å€¼ä¸º **x**ï¼Œé‚£ä¹ˆ **```left.val = 2 * x + 1```** å¹¶ä¸” **```right.val = 2 * x + 2```**\n\nç”±æ­¤å¯çŸ¥ï¼Œ**```left.val```** ä¸€å®šä¸º **å¥‡æ•°**ï¼Œ**```right.val```** ä¸€å®šä¸º **å¶æ•°**\n\né‚£ä¹ˆå¯ä»¥åˆ©ç”¨è¿™ä¸€ç‰¹æ€§è¿›è¡Œ **åå‘æ¨å¯¼**\n\n## ä¸¾ä¸ªğŸŒ°ï¼šæŸ¥æ‰¾ 13 æ˜¯å¦åœ¨æ ‘ä¸­\n\nå› ä¸º **13** ä¸ºå¥‡æ•°ï¼Œé‚£ä¹ˆé€šè¿‡ ```2 * x + 1 === 13``` å¯å¾— ```x === 6``` , **6** çš„ ```left``` ä¸º **13**\n\né€’å½’æŸ¥æ‰¾ **6**\n\nå› ä¸º **6** ä¸ºå¶æ•°ï¼Œé‚£ä¹ˆé€šè¿‡ ```2 * x + 2 === 6``` å¯å¾— ```x === 2```, **2** çš„ ```right``` ä¸º **6**\n\nä¸Šè¿°æ“ä½œè¿›è¡Œé€’å½’å¤„ç†ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªè®¿é—®è·¯å¾„æ ˆ ```stack```\n\n```typescript\n[\n  { val: 6, nextDirection: 'left' },\n  { val: 2, nextDirection: 'right' },\n  { val: 0, nextDirection: 'right' },\n]\n// æ³¨ï¼šå®é™…è¿‡ç¨‹å¯ä¸å­˜å‚¨ val å€¼\n// ä¸Šè¿°è¿‡ç¨‹è¡¨ç¤ºï¼š\n// 0 çš„ right ä¸º 2\n// 2 çš„ right ä¸º 6\n// 6 çš„ left ä¸º target\n```\n\n## æ€»ç»“ï¼š\n1. å…ˆé€’å½’æŸ¥æ‰¾è®¿é—®è·¯å¾„ï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ª ```nextDirection``` æ ˆ\n2. ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œå½“ ```root``` åŠ ```stack``` ä¸ä¸ºç©ºçš„æ—¶å€™ï¼Œä¾æ¬¡å¯¹æ ˆé¡¶å…ƒç´ è¿›è¡Œå‡ºæ ˆå¤„ç†\n3. æœ€ç»ˆåˆ¤æ–­ ```stack``` ä¸ºç©ºæ—¶ï¼Œ```root.val``` æ˜¯å¦ç­‰äº ```target```\n\n## å®Œæ•´ä»£ç ï¼ˆTypeScriptï¼‰ï¼š\n\n```typescript\nclass FindElements {\n    constructor(private root: TreeNode | null) {\n        this.root = this.recoverTree(root, 0)\n    }\n    \n    find(target: number): boolean {\n        if (target === 0) return true\n        \n        // 1.è¿˜åŸè®¿é—®è·¯å¾„\n        const stack = this.recoverPath(target, [])\n        \n        // 2.æŸ¥æ‰¾\n        let root = this.root\n        while(stack.length && root) {\n            const direction = stack.pop()\n            root = root[direction]\n        }\n        return stack.length > 0 || !root ? false : root.val === target\n    }\n    \n    /**\n     * åˆ©ç”¨ left ä¸ºå¥‡æ•°ï¼Œright ä¸ºå¶æ•°ç‰¹æ€§è¿˜åŸè®¿é—®è·¯å¾„\n     */\n    private recoverPath(target: number, stack: ('left' | 'right')[]) {\n        if (target === 0) return stack\n        \n        let v:number\n        if (target % 2 === 0) {\n            v = (target - 2) / 2\n            stack.push('right')\n        } else {\n            v = (target - 1) / 2\n            stack.push('left')\n        }\n        \n        this.recoverPath(v, stack)\n        return stack\n    }\n    \n    /**\n     * æ¢å¤è¢«æ±¡æŸ“çš„æ ‘\n    */\n    private recoverTree(root: TreeNode | null, v: number) {\n        if (!root)  return\n        \n        root.val = v\n        this.recoverTree(root.left, v * 2 + 1)\n        this.recoverTree(root.right, v * 2 + 2)\n        return root\n    }\n}\n```"
}