{
	"titleSlug": "sqrtx",
	"slug": "x-de-ping-fang-gen-by-leetcode-solution",
	"url": "https://leetcode-cn.com/problems/sqrtx/solution/x-de-ping-fang-gen-by-leetcode-solution/",
	"content": "### ğŸ“º è§†é¢‘é¢˜è§£  \n![69 xçš„å¹³æ–¹æ ¹ ä»²è€€æ™–.mp4](6d3985c2-8ccf-4fc7-8eda-2b58b4d33362)\n\n### ğŸ“– æ–‡å­—é¢˜è§£\n\n#### å‰è¨€\n\næœ¬é¢˜æ˜¯ä¸€é“å¸¸è§çš„é¢è¯•é¢˜ï¼Œé¢è¯•å®˜ä¸€èˆ¬ä¼šè¦æ±‚é¢è¯•è€…åœ¨ä¸ä½¿ç”¨ $\\sqrt{x}$ å‡½æ•°çš„æƒ…å†µä¸‹ï¼Œå¾—åˆ° $x$ çš„å¹³æ–¹æ ¹çš„æ•´æ•°éƒ¨åˆ†ã€‚ä¸€èˆ¬çš„æ€è·¯ä¼šæœ‰ä»¥ä¸‹å‡ ç§ï¼š\n\n- é€šè¿‡å…¶å®ƒçš„æ•°å­¦å‡½æ•°ä»£æ›¿å¹³æ–¹æ ¹å‡½æ•°å¾—åˆ°ç²¾ç¡®ç»“æœï¼Œå–æ•´æ•°éƒ¨åˆ†ä½œä¸ºç­”æ¡ˆï¼›\n\n- é€šè¿‡æ•°å­¦æ–¹æ³•å¾—åˆ°è¿‘ä¼¼ç»“æœï¼Œç›´æ¥ä½œä¸ºç­”æ¡ˆã€‚\n\n#### æ–¹æ³•ä¸€ï¼šè¢–çè®¡ç®—å™¨ç®—æ³•\n\nã€Œè¢–çè®¡ç®—å™¨ç®—æ³•ã€æ˜¯ä¸€ç§ç”¨æŒ‡æ•°å‡½æ•° $\\exp$ å’Œå¯¹æ•°å‡½æ•° $\\ln$ ä»£æ›¿å¹³æ–¹æ ¹å‡½æ•°çš„æ–¹æ³•ã€‚æˆ‘ä»¬é€šè¿‡æœ‰é™çš„å¯ä»¥ä½¿ç”¨çš„æ•°å­¦å‡½æ•°ï¼Œå¾—åˆ°æˆ‘ä»¬æƒ³è¦è®¡ç®—çš„ç»“æœã€‚\n\næˆ‘ä»¬å°† $\\sqrt{x}$ å†™æˆå¹‚çš„å½¢å¼ $x^{1/2}$ï¼Œå†ä½¿ç”¨è‡ªç„¶å¯¹æ•° $e$ è¿›è¡Œæ¢åº•ï¼Œå³å¯å¾—åˆ°\n\n$$\n\\sqrt{x} = x^{1/2} = (e ^ {\\ln x})^{1/2} = e^{\\frac{1}{2} \\ln x}\n$$\n\nè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ° $\\sqrt{x}$ çš„å€¼äº†ã€‚\n\n**æ³¨æ„ï¼š** ç”±äºè®¡ç®—æœºæ— æ³•å­˜å‚¨æµ®ç‚¹æ•°çš„ç²¾ç¡®å€¼ï¼ˆæµ®ç‚¹æ•°çš„å­˜å‚¨æ–¹æ³•å¯ä»¥å‚è€ƒ [IEEE 754](https://baike.baidu.com/item/IEEE%20754)ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼‰ï¼Œè€ŒæŒ‡æ•°å‡½æ•°å’Œå¯¹æ•°å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼å‡ä¸ºæµ®ç‚¹æ•°ï¼Œå› æ­¤è¿ç®—è¿‡ç¨‹ä¸­ä¼šå­˜åœ¨è¯¯å·®ã€‚ä¾‹å¦‚å½“ $x = 2147395600$ æ—¶ï¼Œ$e^{\\frac{1}{2} \\ln x}$ çš„è®¡ç®—ç»“æœä¸æ­£ç¡®å€¼ $46340$ ç›¸å·® $10^{-11}$ï¼Œè¿™æ ·åœ¨å¯¹ç»“æœå–æ•´æ•°éƒ¨åˆ†æ—¶ï¼Œä¼šå¾—åˆ° $46339$ è¿™ä¸ªé”™è¯¯çš„ç»“æœã€‚\n\nå› æ­¤åœ¨å¾—åˆ°ç»“æœçš„æ•´æ•°éƒ¨åˆ† $\\textit{ans}$ åï¼Œæˆ‘ä»¬åº”å½“æ‰¾å‡º $\\textit{ans}$ ä¸ $\\textit{ans} + 1$ ä¸­å“ªä¸€ä¸ªæ˜¯çœŸæ­£çš„ç­”æ¡ˆã€‚\n\n```C++ [sol1-C++]\nclass Solution {\npublic:\n    int mySqrt(int x) {\n        if (x == 0) {\n            return 0;\n        }\n        int ans = exp(0.5 * log(x));\n        return ((long long)(ans + 1) * (ans + 1) <= x ? ans + 1 : ans);\n    }\n};\n```\n\n```Java [sol1-Java]\nclass Solution {\n    public int mySqrt(int x) {\n        if (x == 0) {\n            return 0;\n        }\n        int ans = (int) Math.exp(0.5 * Math.log(x));\n        return (long) (ans + 1) * (ans + 1) <= x ? ans + 1 : ans;\n    }\n}\n```\n\n```Python [sol1-Python3]\nclass Solution:\n    def mySqrt(self, x: int) -> int:\n        if x == 0:\n            return 0\n        ans = int(math.exp(0.5 * math.log(x)))\n        return ans + 1 if (ans + 1) ** 2 <= x else ans\n```\n\n```golang [sol1-Golang]\nfunc mySqrt(x int) int {\n    if x == 0 {\n        return 0\n    }\n    ans := int(math.Exp(0.5 * math.Log(float64(x))))\n    if (ans + 1) * (ans + 1) <= x {\n        return ans + 1\n    }\n    return ans\n}\n```\n\n**å¤æ‚åº¦åˆ†æ**\n\n* æ—¶é—´å¤æ‚åº¦ï¼š$O(1)$ï¼Œç”±äºå†…ç½®çš„ `exp` å‡½æ•°ä¸ `log` å‡½æ•°ä¸€èˆ¬éƒ½å¾ˆå¿«ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå°†å…¶å¤æ‚åº¦è§†ä¸º $O(1)$ã€‚\n\n* ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$ã€‚\n\n#### æ–¹æ³•äºŒï¼šäºŒåˆ†æŸ¥æ‰¾\n\nç”±äº $x$ å¹³æ–¹æ ¹çš„æ•´æ•°éƒ¨åˆ† $\\textit{ans}$ æ˜¯**æ»¡è¶³ $k^2 \\leq x$ çš„æœ€å¤§ $k$ å€¼**ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¯¹ $k$ è¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾ï¼Œä»è€Œå¾—åˆ°ç­”æ¡ˆã€‚\n\näºŒåˆ†æŸ¥æ‰¾çš„ä¸‹ç•Œä¸º $0$ï¼Œä¸Šç•Œå¯ä»¥ç²—ç•¥åœ°è®¾å®šä¸º $x$ã€‚åœ¨äºŒåˆ†æŸ¥æ‰¾çš„æ¯ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦æ¯”è¾ƒä¸­é—´å…ƒç´  $\\textit{mid}$ çš„å¹³æ–¹ä¸ $x$ çš„å¤§å°å…³ç³»ï¼Œå¹¶é€šè¿‡æ¯”è¾ƒçš„ç»“æœè°ƒæ•´ä¸Šä¸‹ç•Œçš„èŒƒå›´ã€‚ç”±äºæˆ‘ä»¬æ‰€æœ‰çš„è¿ç®—éƒ½æ˜¯æ•´æ•°è¿ç®—ï¼Œä¸ä¼šå­˜åœ¨è¯¯å·®ï¼Œå› æ­¤åœ¨å¾—åˆ°æœ€ç»ˆçš„ç­”æ¡ˆ $\\textit{ans}$ åï¼Œä¹Ÿå°±ä¸éœ€è¦å†å»å°è¯• $\\textit{ans} + 1$ äº†ã€‚\n\n```C++ [sol2-C++]\nclass Solution {\npublic:\n    int mySqrt(int x) {\n        int l = 0, r = x, ans = -1;\n        while (l <= r) {\n            int mid = l + (r - l) / 2;\n            if ((long long)mid * mid <= x) {\n                ans = mid;\n                l = mid + 1;\n            } else {\n                r = mid - 1;\n            }\n        }\n        return ans;\n    }\n};\n```\n\n```Java [sol2-Java]\nclass Solution {\n    public int mySqrt(int x) {\n        int l = 0, r = x, ans = -1;\n        while (l <= r) {\n            int mid = l + (r - l) / 2;\n            if ((long) mid * mid <= x) {\n                ans = mid;\n                l = mid + 1;\n            } else {\n                r = mid - 1;\n            }\n        }\n        return ans;\n    }\n}\n```\n\n```Python [sol2-Python3]\nclass Solution:\n    def mySqrt(self, x: int) -> int:\n        l, r, ans = 0, x, -1\n        while l <= r:\n            mid = (l + r) // 2\n            if mid * mid <= x:\n                ans = mid\n                l = mid + 1\n            else:\n                r = mid - 1\n        return ans\n```\n\n```golang [sol2-Golang]\nfunc mySqrt(x int) int {\n    l, r := 0, x\n    ans := -1\n    for l <= r {\n        mid := l + (r - l) / 2\n        if mid * mid <= x {\n            ans = mid\n            l = mid + 1\n        } else {\n            r = mid - 1\n        }\n    }\n    return ans\n}\n```\n\n**å¤æ‚åº¦åˆ†æ**\n\n* æ—¶é—´å¤æ‚åº¦ï¼š$O(\\log x)$ï¼Œå³ä¸ºäºŒåˆ†æŸ¥æ‰¾éœ€è¦çš„æ¬¡æ•°ã€‚\n\n* ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$ã€‚\n\n#### æ–¹æ³•ä¸‰ï¼šç‰›é¡¿è¿­ä»£\n\n**æ€è·¯**\n\n[ç‰›é¡¿è¿­ä»£æ³•](https://baike.baidu.com/item/%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3%E6%B3%95)æ˜¯ä¸€ç§å¯ä»¥ç”¨æ¥å¿«é€Ÿæ±‚è§£å‡½æ•°é›¶ç‚¹çš„æ–¹æ³•ã€‚\n\nä¸ºäº†å™è¿°æ–¹ä¾¿ï¼Œæˆ‘ä»¬ç”¨ $C$ è¡¨ç¤ºå¾…æ±‚å‡ºå¹³æ–¹æ ¹çš„é‚£ä¸ªæ•´æ•°ã€‚æ˜¾ç„¶ï¼Œ$C$ çš„å¹³æ–¹æ ¹å°±æ˜¯å‡½æ•°\n\n$$\ny = f(x) = x^2 - C\n$$\n\nçš„é›¶ç‚¹ã€‚\n\nç‰›é¡¿è¿­ä»£æ³•çš„æœ¬è´¨æ˜¯å€ŸåŠ©æ³°å‹’çº§æ•°ï¼Œä»åˆå§‹å€¼å¼€å§‹å¿«é€Ÿå‘é›¶ç‚¹é€¼è¿‘ã€‚æˆ‘ä»¬ä»»å–ä¸€ä¸ª $x_0$ ä½œä¸ºåˆå§‹å€¼ï¼Œåœ¨æ¯ä¸€æ­¥çš„è¿­ä»£ä¸­ï¼Œæˆ‘ä»¬æ‰¾åˆ°å‡½æ•°å›¾åƒä¸Šçš„ç‚¹ $(x_i, f(x_i))$ï¼Œè¿‡è¯¥ç‚¹ä½œä¸€æ¡æ–œç‡ä¸ºè¯¥ç‚¹å¯¼æ•° $f'(x_i)$ çš„ç›´çº¿ï¼Œä¸æ¨ªè½´çš„äº¤ç‚¹è®°ä¸º $x_{i+1}$ã€‚$x_{i+1}$ ç›¸è¾ƒäº $x_i$ è€Œè¨€è·ç¦»é›¶ç‚¹æ›´è¿‘ã€‚åœ¨ç»è¿‡å¤šæ¬¡è¿­ä»£åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªè·ç¦»é›¶ç‚¹éå¸¸æ¥è¿‘çš„äº¤ç‚¹ã€‚ä¸‹å›¾ç»™å‡ºäº†ä» $x_0$ å¼€å§‹è¿­ä»£ä¸¤æ¬¡ï¼Œå¾—åˆ° $x_1$ å’Œ $x_2$ çš„è¿‡ç¨‹ã€‚\n\n![fig1](https://assets.leetcode-cn.com/solution-static/69/69_fig1.png)\n\n**ç®—æ³•**\n\næˆ‘ä»¬é€‰æ‹© $x_0 = C$ ä½œä¸ºåˆå§‹å€¼ã€‚\n\nåœ¨æ¯ä¸€æ­¥è¿­ä»£ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å½“å‰çš„äº¤ç‚¹ $x_i$ï¼Œæ‰¾åˆ°å‡½æ•°å›¾åƒä¸Šçš„ç‚¹ $(x_i, x_i^2 - C)$ï¼Œä½œä¸€æ¡æ–œç‡ä¸º $f'(x_i) = 2x_i$ çš„ç›´çº¿ï¼Œç›´çº¿çš„æ–¹ç¨‹ä¸ºï¼š\n\n$$\n\\begin{aligned}\ny_l &= 2x_i(x - x_i) + x_i^2 - C \\\\\n&= 2x_ix - (x_i^2 + C)\n\\end{aligned}\n$$\n\nä¸æ¨ªè½´çš„äº¤ç‚¹ä¸ºæ–¹ç¨‹ $2x_ix - (x_i^2 + C) = 0$ çš„è§£ï¼Œå³ä¸ºæ–°çš„è¿­ä»£ç»“æœ $x_{i+1}$ï¼š\n\n$$\nx_{i+1} = \\frac{1}{2}\\left(x_i + \\frac{C}{x_i}\\right)\n$$\n\nåœ¨è¿›è¡Œ $k$ æ¬¡è¿­ä»£åï¼Œ$x_k$ çš„å€¼ä¸çœŸå®çš„é›¶ç‚¹ $\\sqrt{C}$ è¶³å¤Ÿæ¥è¿‘ï¼Œå³å¯ä½œä¸ºç­”æ¡ˆã€‚\n\n**ç»†èŠ‚**\n\n- ä¸ºä»€ä¹ˆé€‰æ‹© $x_0 = C$ ä½œä¸ºåˆå§‹å€¼ï¼Ÿ\n\n    - å› ä¸º $y = x^2 - C$ æœ‰ä¸¤ä¸ªé›¶ç‚¹ $-\\sqrt{C}$ å’Œ $\\sqrt{C}$ã€‚å¦‚æœæˆ‘ä»¬å–çš„åˆå§‹å€¼è¾ƒå°ï¼Œå¯èƒ½ä¼šè¿­ä»£åˆ° $-\\sqrt{C}$ è¿™ä¸ªé›¶ç‚¹ï¼Œè€Œæˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°çš„æ˜¯ $\\sqrt{C}$ è¿™ä¸ªé›¶ç‚¹ã€‚å› æ­¤é€‰æ‹© $x_0 = C$ ä½œä¸ºåˆå§‹å€¼ï¼Œæ¯æ¬¡è¿­ä»£å‡æœ‰ $x_{i+1} < x_i$ï¼Œé›¶ç‚¹ $\\sqrt{C}$ åœ¨å…¶å·¦ä¾§ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€å®šä¼šè¿­ä»£åˆ°è¿™ä¸ªé›¶ç‚¹ã€‚\n\n- è¿­ä»£åˆ°ä½•æ—¶æ‰ç®—ç»“æŸï¼Ÿ\n\n    - æ¯ä¸€æ¬¡è¿­ä»£åï¼Œæˆ‘ä»¬éƒ½ä¼šè·ç¦»é›¶ç‚¹æ›´è¿›ä¸€æ­¥ï¼Œæ‰€ä»¥å½“ç›¸é‚»ä¸¤æ¬¡è¿­ä»£å¾—åˆ°çš„äº¤ç‚¹**éå¸¸æ¥è¿‘**æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ–­å®šï¼Œæ­¤æ—¶çš„ç»“æœå·²ç»è¶³å¤Ÿæˆ‘ä»¬å¾—åˆ°ç­”æ¡ˆäº†ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¯ä»¥åˆ¤æ–­ç›¸é‚»ä¸¤æ¬¡è¿­ä»£çš„ç»“æœçš„å·®å€¼æ˜¯å¦å°äºä¸€ä¸ªæå°çš„éè´Ÿæ•° $\\epsilon$ï¼Œå…¶ä¸­ $\\epsilon$ ä¸€èˆ¬å¯ä»¥å– $10^{-6}$ æˆ– $10^{-7}$ã€‚\n\n- å¦‚ä½•é€šè¿‡è¿­ä»£å¾—åˆ°çš„è¿‘ä¼¼é›¶ç‚¹å¾—å‡ºæœ€ç»ˆçš„ç­”æ¡ˆï¼Ÿ\n\n    - ç”±äº $y = f(x)$ åœ¨ $[\\sqrt{C}, +\\infty]$ ä¸Šæ˜¯å‡¸å‡½æ•°ï¼ˆconvex functionï¼‰ä¸”æ’å¤§äºç­‰äºé›¶ï¼Œé‚£ä¹ˆåªè¦æˆ‘ä»¬é€‰å–çš„åˆå§‹å€¼ $x_0$ å¤§äºç­‰äº $\\sqrt{C}$ï¼Œæ¯æ¬¡è¿­ä»£å¾—åˆ°çš„ç»“æœ $x_i$ éƒ½ä¼šæ’å¤§äºç­‰äº $\\sqrt{C}$ã€‚å› æ­¤åªè¦ $\\epsilon$ é€‰æ‹©åœ°è¶³å¤Ÿå°ï¼Œæœ€ç»ˆçš„ç»“æœ $x_k$ åªä¼šç¨ç¨å¤§äºçœŸæ­£çš„é›¶ç‚¹ $\\sqrt{C}$ã€‚åœ¨é¢˜ç›®ç»™å‡ºçš„ 32 ä½æ•´æ•°èŒƒå›´å†…ï¼Œä¸ä¼šå‡ºç°ä¸‹é¢çš„æƒ…å†µï¼š\n\n      > çœŸæ­£çš„é›¶ç‚¹ä¸º $n - 1/2\\epsilon$ï¼Œå…¶ä¸­ $n$ æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œè€Œæˆ‘ä»¬è¿­ä»£å¾—åˆ°çš„ç»“æœä¸º $n + 1/2\\epsilon$ã€‚åœ¨å¯¹ç»“æœä¿ç•™æ•´æ•°éƒ¨åˆ†åå¾—åˆ° $n$ï¼Œä½†æ­£ç¡®çš„ç»“æœä¸º $n - 1$ã€‚\n\n```C++ [sol3-C++]\nclass Solution {\npublic:\n    int mySqrt(int x) {\n        if (x == 0) {\n            return 0;\n        }\n\n        double C = x, x0 = x;\n        while (true) {\n            double xi = 0.5 * (x0 + C / x0);\n            if (fabs(x0 - xi) < 1e-7) {\n                break;\n            }\n            x0 = xi;\n        }\n        return int(x0);\n    }\n};\n```\n\n```Java [sol3-Java]\nclass Solution {\n    public int mySqrt(int x) {\n        if (x == 0) {\n            return 0;\n        }\n\n        double C = x, x0 = x;\n        while (true) {\n            double xi = 0.5 * (x0 + C / x0);\n            if (Math.abs(x0 - xi) < 1e-7) {\n                break;\n            }\n            x0 = xi;\n        }\n        return (int) x0;\n    }\n}\n```\n\n```Python [sol3-Python3]\nclass Solution:\n    def mySqrt(self, x: int) -> int:\n        if x == 0:\n            return 0\n        \n        C, x0 = float(x), float(x)\n        while True:\n            xi = 0.5 * (x0 + C / x0)\n            if abs(x0 - xi) < 1e-7:\n                break\n            x0 = xi\n        \n        return int(x0)\n```\n\n```golang [sol3-Golang]\nfunc mySqrt(x int) int {\n    if x == 0 {\n        return 0\n    }\n    C, x0 := float64(x), float64(x)\n    for {\n        xi := 0.5 * (x0 + C/x0)\n        if math.Abs(x0 - xi) < 1e-7 {\n            break\n        }\n        x0 = xi\n    }\n    return int(x0)\n}\n```\n\n**å¤æ‚åº¦åˆ†æ**\n\n* æ—¶é—´å¤æ‚åº¦ï¼š$O(\\log x)$ï¼Œæ­¤æ–¹æ³•æ˜¯äºŒæ¬¡æ”¶æ•›çš„ï¼Œç›¸è¾ƒäºäºŒåˆ†æŸ¥æ‰¾æ›´å¿«ã€‚\n\n* ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$ã€‚"
}