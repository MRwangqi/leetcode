{
	"titleSlug": "cheapest-flights-within-k-stops",
	"slug": "gong-shui-san-xie-xiang-jie-bellman-ford-dc94",
	"url": "https://leetcode-cn.com/problems/cheapest-flights-within-k-stops/solution/gong-shui-san-xie-xiang-jie-bellman-ford-dc94/",
	"content": "## åŸºæœ¬åˆ†æ\n\nä»é¢˜é¢çœ‹å°±èƒ½çŸ¥é“ï¼Œè¿™æ˜¯ä¸€ç±»ã€Œæœ‰é™åˆ¶ã€çš„æœ€çŸ­è·¯é—®é¢˜ã€‚\n\nã€Œé™åˆ¶æœ€å¤šç»è¿‡ä¸è¶…è¿‡ $k$ ä¸ªç‚¹ã€ç­‰ä»·äºã€Œé™åˆ¶æœ€å¤šä¸è¶…è¿‡ $k + 1$ æ¡è¾¹ã€ï¼Œè€Œè§£å†³ã€Œæœ‰è¾¹æ•°é™åˆ¶çš„æœ€çŸ­è·¯é—®é¢˜ã€æ˜¯ SPFA æ‰€ä¸èƒ½å–ä»£ Bellman Ford ç®—æ³•çš„ç»å…¸åº”ç”¨ä¹‹ä¸€ï¼ˆSPFA èƒ½åšï¼Œä½†ä¸èƒ½ç›´æ¥åšï¼‰ã€‚\n\n**Bellman Ford/SPFA éƒ½æ˜¯åŸºäºåŠ¨æ€è§„åˆ’ï¼Œå…¶åŸå§‹çš„çŠ¶æ€å®šä¹‰ä¸º $f[i][k]$ ä»£è¡¨ä»èµ·ç‚¹åˆ° $i$ ç‚¹ï¼Œä¸”ç»è¿‡æœ€å¤š $k$ æ¡è¾¹çš„æœ€çŸ­è·¯å¾„ã€‚è¿™æ ·çš„çŠ¶æ€å®šä¹‰å¼•å¯¼æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ Bellman Ford æ¥è§£å†³æœ‰è¾¹æ•°é™åˆ¶çš„æœ€çŸ­è·¯é—®é¢˜ã€‚**\n\n**åŒæ ·å¤šæºæ±‡æœ€çŸ­è·¯ç®—æ³• Floyd ä¹Ÿæ˜¯åŸºäºåŠ¨æ€è§„åˆ’ï¼Œå…¶åŸå§‹çš„ä¸‰ç»´çŠ¶æ€å®šä¹‰ä¸º $f[i][j][k]$ ä»£è¡¨ä»ç‚¹ $i$ åˆ°ç‚¹ $j$ï¼Œä¸”ç»è¿‡çš„æ‰€æœ‰ç‚¹ç¼–å·ä¸ä¼šè¶…è¿‡ $k$ï¼ˆå³å¯ä½¿ç”¨ç‚¹ç¼–å·èŒƒå›´ä¸º $[1, k]$ï¼‰çš„æœ€çŸ­è·¯å¾„ã€‚è¿™æ ·çš„çŠ¶æ€å®šä¹‰å¼•å¯¼æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ Floyd æ±‚æœ€å°ç¯æˆ–è€…æ±‚â€œé‡å¿ƒç‚¹â€ï¼ˆå³åˆ é™¤è¯¥ç‚¹åï¼Œæœ€çŸ­è·¯å€¼ä¼šå˜å¤§ï¼‰ã€‚**\n\nå¦‚æœä½ å¯¹å‡ ç±»æœ€çŸ­ç®—æ³•ä¸ç†Ÿæ‚‰ï¼Œå¯ä»¥çœ‹ [è¿™é‡Œ](https://mp.weixin.qq.com/s?__biz=MzU4NDE3MTEyMA==&mid=2247488007&idx=1&sn=9d0dcfdf475168d26a5a4bd6fcd3505d&chksm=fd9cb918caeb300e1c8844583db5c5318a89e60d8d552747ff8c2256910d32acd9013c93058f&token=754098973&lang=zh_CN#rd)ï¼Œé‡Œé¢æ¶µç›–æ‰€æœ‰çš„ã€Œæœ€çŸ­è·¯ç®—æ³•ã€å’Œã€Œå­˜å›¾æ–¹å¼ã€ã€‚\n \n---\n\n## Bellman Ford + é‚»æ¥çŸ©é˜µ\n\nå›åˆ°æœ¬é¢˜ï¼Œã€Œé™åˆ¶æœ€å¤šç»è¿‡ä¸è¶…è¿‡ $k$ ä¸ªç‚¹ã€ç­‰ä»·äºã€Œé™åˆ¶æœ€å¤šä¸è¶…è¿‡ $k + 1$ æ¡è¾¹ã€ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ Bellman Ford æ¥æ±‚è§£ã€‚\n\nç‚¹çš„æ•°é‡åªæœ‰ $100$ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ã€Œé‚»æ¥çŸ©é˜µã€çš„æ–¹å¼è¿›è¡Œå­˜å›¾ã€‚\n\n> éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨éå†æ‰€æœ‰çš„â€œç‚¹å¯¹/è¾¹â€è¿›è¡Œæ¾å¼›æ“ä½œå‰ï¼Œéœ€è¦å…ˆå¯¹ $dist$ è¿›è¡Œå¤‡ä»½ï¼Œå¦åˆ™ä¼šå‡ºç°ã€Œæœ¬æ¬¡æ¾å¼›æ“ä½œæ‰€ä½¿ç”¨åˆ°çš„è¾¹ï¼Œä¹Ÿæ˜¯åœ¨åŒä¸€æ¬¡è¿­ä»£æ‰€æ›´æ–°çš„ã€ï¼Œä»è€Œä¸æ»¡è¶³è¾¹æ•°é™åˆ¶çš„è¦æ±‚ã€‚\nä¸¾ä¸ª ğŸŒ°ï¼Œä¾‹å¦‚æœ¬æ¬¡æ¾å¼›æ“ä½œä½¿ç”¨äº†ä» $a$ åˆ° $b$ çš„å½“å‰æœ€çŸ­è·ç¦»æ¥æ›´æ–° $dist[b]$ï¼Œç›´æ¥ä½¿ç”¨ $dist[a]$ çš„è¯ï¼Œä¸èƒ½ç¡®ä¿ $dist[a]$ ä¸æ˜¯åœ¨åŒä¸€æ¬¡è¿­ä»£ä¸­æ‰€æ›´æ–°ï¼Œå¦‚æœ $dist[a]$ æ˜¯åŒä¸€æ¬¡è¿­ä»£æ‰€æ›´æ–°çš„è¯ï¼Œé‚£ä¹ˆä½¿ç”¨çš„è¾¹æ•°å°†ä¼šå¤§äº $k$ æ¡ã€‚\nå› æ­¤åœ¨æ¯æ¬¡è¿­ä»£å¼€å§‹å‰ï¼Œæˆ‘ä»¬éƒ½åº”è¯¥å¯¹ $dist$ è¿›è¡Œå¤‡ä»½ï¼Œåœ¨è¿­ä»£æ—¶ä½¿ç”¨å¤‡ä»½æ¥è¿›è¡Œæ¾å¼›æ“ä½œã€‚\n\n![image.png](https://pic.leetcode-cn.com/1629775402-BKrDNg-image.png)\n\nä»£ç ï¼š\n```Java []\nclass Solution {\n    int N = 110, INF = 0x3f3f3f3f;\n    int[][] g = new int[N][N];\n    int[] dist = new int[N];\n    int n, m, s, t, k;\n    public int findCheapestPrice(int _n, int[][] flights, int _src, int _dst, int _k) {\n        n = _n; s = _src; t = _dst; k = _k + 1;\n        for (int i = 0; i < N; i++) {\n            for (int j = 0; j < N; j++) {\n                g[i][j] = i == j ? 0 : INF;\n            }\n        }\n        for (int[] f : flights) {\n            g[f[0]][f[1]] = f[2];\n        }\n        int ans = bf();\n        return ans > INF / 2 ? -1 : ans;\n    }\n    int bf() {\n        Arrays.fill(dist, INF);\n        dist[s] = 0;\n        for (int limit = 0; limit < k; limit++) {\n            int[] clone = dist.clone();\n            for (int i = 0; i < n; i++) {\n                for (int j = 0; j < n; j++) {\n                    dist[j] = Math.min(dist[j], clone[i] + g[i][j]);\n                }\n            }\n        }\n        return dist[t];\n    }\n}\n```\n* æ—¶é—´å¤æ‚åº¦ï¼š$O(k * n^2)$\n* ç©ºé—´å¤æ‚åº¦ï¼š$O(n^2)$\n\n\n---\n\n## Bellman Ford + ç±»\n\næˆ‘ä»¬çŸ¥é“ Bellman Ford éœ€è¦éå†æ‰€æœ‰çš„è¾¹ï¼Œè€Œä½¿ç”¨ã€Œé‚»æ¥çŸ©é˜µã€çš„å­˜å›¾æ–¹å¼è®©æˆ‘ä»¬ä¸å¾—ä¸éå†æ‰€æœ‰çš„ç‚¹å¯¹ï¼Œå¤æ‚åº¦ä¸º $O(n^2)$ã€‚\n\nè€Œè¾¹çš„æ•°é‡ $m$ çš„æ•°æ®èŒƒå›´ä¸º $0 <= flights.length <= (n * (n - 1) / 2)$ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ã€Œç±»ã€çš„æ–¹å¼è¿›è¡Œå­˜å›¾ï¼Œä»è€Œç¡®ä¿åœ¨éå†æ‰€æœ‰è¾¹çš„æ—¶å€™ï¼Œå¤æ‚åº¦ä¸¥æ ¼ä¸º $O(m)$ï¼Œè€Œä¸æ˜¯ $O(n^2)$ã€‚\n\n![image.png](https://pic.leetcode-cn.com/1629775378-YcJJzg-image.png)\n\nä»£ç ï¼š\n```Java []\nclass Solution {\n    class Edge {\n        int x, y, w;\n        Edge(int _x, int _y, int _w) {\n            x = _x; y = _y; w = _w;\n        }\n    }\n    int N = 110, INF = 0x3f3f3f3f;\n    int[] dist = new int[N];\n    List<Edge> list = new ArrayList<>();\n    int n, m, s, t, k;\n    public int findCheapestPrice(int _n, int[][] flights, int _src, int _dst, int _k) {\n        n = _n; s = _src; t = _dst; k = _k + 1;\n        for (int[] f : flights) {\n            list.add(new Edge(f[0], f[1], f[2]));\n        }\n        m = list.size();\n        int ans = bf();\n        return ans > INF / 2 ? -1 : ans;\n    }\n    int bf() {\n        Arrays.fill(dist, INF);\n        dist[s] = 0;\n        for (int i = 0; i < k; i++) {\n            int[] clone = dist.clone();\n            for (Edge e : list) {\n                int x = e.x, y = e.y, w = e.w;\n                dist[y] = Math.min(dist[y], clone[x] + w);\n            }\n        }\n        return dist[t];\n    }\n}\n```\n* æ—¶é—´å¤æ‚åº¦ï¼šå…±è¿›è¡Œ $k + 1$ æ¬¡è¿­ä»£ï¼Œæ¯æ¬¡è¿­ä»£å¤‡ä»½æ•°ç»„å¤æ‚åº¦ä¸º $O(n)$ï¼Œç„¶åéå†æ‰€æœ‰çš„è¾¹è¿›è¡Œæ¾å¼›æ“ä½œï¼Œå¤æ‚åº¦ä¸º $O(m)$ã€‚æ•´ä½“å¤æ‚åº¦ä¸º $O(k * (n + m))$\n* ç©ºé—´å¤æ‚åº¦ï¼š$O(n + m)$\n\n---\n\n## Bellman Ford\n\næ›´è¿›ä¸€æ­¥ï¼Œç”±äº Bellman Ford æ ¸å¿ƒæ“ä½œéœ€è¦éå†æ‰€æœ‰çš„è¾¹ï¼Œå› æ­¤ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ $flights$ æ•°ç»„ä½œä¸ºå­˜å›¾ä¿¡æ¯ï¼Œè€Œæ— é¡»é¢å¤–å­˜å›¾ã€‚\n\n![image.png](https://pic.leetcode-cn.com/1629775353-jTgEoB-image.png)\n\nä»£ç ï¼š\n```Java []\nclass Solution {\n    int N = 110, INF = 0x3f3f3f3f;\n    int[] dist = new int[N];\n    public int findCheapestPrice(int n, int[][] flights, int src, int dst, int k) {\n        Arrays.fill(dist, INF);\n        dist[src] = 0;\n        for (int limit = 0; limit < k + 1; limit++) {\n            int[] clone = dist.clone();\n            for (int[] f : flights) {\n                int x = f[0], y = f[1], w = f[2];\n                dist[y] = Math.min(dist[y], clone[x] + w);\n            }\n        }\n        return dist[dst] > INF / 2 ? -1 : dist[dst];\n    }\n}\n```\n* æ—¶é—´å¤æ‚åº¦ï¼šå…±è¿›è¡Œ $k + 1$ æ¬¡è¿­ä»£ï¼Œæ¯æ¬¡è¿­ä»£å¤‡ä»½æ•°ç»„å¤æ‚åº¦ä¸º $O(n)$ï¼Œç„¶åéå†æ‰€æœ‰çš„è¾¹è¿›è¡Œæ¾å¼›æ“ä½œï¼Œå¤æ‚åº¦ä¸º $O(m)$ã€‚æ•´ä½“å¤æ‚åº¦ä¸º $O(k * (n + m))$\n* ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$\n\n---\n\n## æœ€å\n\n**å¦‚æœæœ‰å¸®åŠ©åˆ°ä½ ï¼Œè¯·ç»™é¢˜è§£ç‚¹ä¸ªèµå’Œæ”¶è—ï¼Œè®©æ›´å¤šçš„äººçœ‹åˆ° ~ (\"â–”â–¡â–”)/**\n\nä¹Ÿæ¬¢è¿ä½  [å…³æ³¨æˆ‘](https://oscimg.oschina.net/oscnet/up-19688dc1af05cf8bdea43b2a863038ab9e5.png)ï¼ˆå…¬ä¸»å·åå°å›å¤ã€Œé€ä¹¦ã€å³å¯å‚ä¸é•¿æœŸçœ‹é¢˜è§£å­¦ç®—æ³•é€å®ä½“ä¹¦æ´»åŠ¨ï¼‰æˆ– åŠ å…¥[ã€Œç»„é˜Ÿæ‰“å¡ã€](https://leetcode-cn.com/u/ac_oier/)å°ç¾¤ ï¼Œæä¾›å†™ã€Œè¯æ˜ã€&ã€Œæ€è·¯ã€çš„é«˜è´¨é‡é¢˜è§£ã€‚\n\næ‰€æœ‰é¢˜è§£å·²ç»åŠ å…¥ [åˆ·é¢˜æŒ‡å—](https://github.com/SharingSource/LogicStack-LeetCode/wiki)ï¼Œæ¬¢è¿ star å“¦ ~ "
}